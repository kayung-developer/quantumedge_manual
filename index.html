<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantumEdge Terminal - User Manual</title>
    <style>
        /* Table of Contents:
        1.  Global Styles & Variables
        2.  Light Theme Definition
        3.  Layout (Sidebar & Main Content)
        4.  Sidebar Navigation
        5.  Typography & Content Elements
        6.  Code Blocks & Copy Button
        7.  Callout Boxes (Info, Warning, Tip)
        8.  Interactive Elements (Search, Theme Toggle)
        9.  Responsive Design
        */

        /* 1. Global Styles & Variables */
        :root {
            --dark-bg: #0D1117;
            --dark-bg-secondary: #161B22;
            --dark-border: #30363D;
            --dark-text: #E6EDF3;
            --dark-text-secondary: #8B949E;
            --primary-accent: #5E56F0;
            --primary-accent-hover: #4B45C0;
            --green: #28A745;
            --red: #DC3545;
            --yellow: #FFC107;

            --light-bg: #FFFFFF;
            --light-bg-secondary: #F6F8FA;
            --light-border: #D0D7DE;
            --light-text: #24292F;
            --light-text-secondary: #57606A;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--dark-bg);
            color: var(--dark-text);
            line-height: 1.6;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        /* 2. Light Theme Definition */
        body.light-mode {
            background-color: var(--light-bg-secondary);
            color: var(--light-text);
        }

        /* 3. Layout */
        .container {
            display: flex;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            background-color: var(--dark-bg-secondary);
            border-right: 1px solid var(--dark-border);
            padding: 20px;
            overflow-y: auto;
            transition: background-color 0.2s ease, border-right 0.2s ease;
        }

        .main-content {
            margin-left: 280px;
            padding: 40px;
            width: calc(100% - 280px);
        }

        body.light-mode .sidebar {
            background-color: var(--light-bg);
            border-right: 1px solid var(--light-border);
        }

        /* 4. Sidebar Navigation */
        .sidebar h2 {
            font-size: 1.2em;
            color: var(--primary-accent);
            margin-bottom: 10px;
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar ul li a {
            display: block;
            padding: 8px 10px;
            color: var(--dark-text-secondary);
            text-decoration: none;
            border-radius: 6px;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        body.light-mode .sidebar ul li a {
            color: var(--light-text-secondary);
        }

        .sidebar ul li a:hover {
            background-color: var(--dark-border);
            color: var(--dark-text);
        }

        body.light-mode .sidebar ul li a:hover {
            background-color: #e8ecf1;
            color: var(--light-text);
        }

        .sidebar ul li a.active {
            background-color: var(--primary-accent);
            color: white;
            font-weight: 600;
        }

        /* 5. Typography & Content Elements */
        article {
            display: none; /* Hidden by default, shown by JS */
            padding-bottom: 60px;
            border-bottom: 1px solid var(--dark-border);
            margin-bottom: 40px;
        }

        body.light-mode article {
             border-bottom: 1px solid var(--light-border);
        }

        article.active {
            display: block;
        }

        h1, h2, h3 {
            color: var(--dark-text);
            margin-bottom: 1em;
            margin-top: 1.5em;
            border-bottom: 1px solid var(--dark-border);
            padding-bottom: 0.5em;
        }

        body.light-mode h1, body.light-mode h2, body.light-mode h3 {
            color: var(--light-text);
            border-bottom: 1px solid var(--light-border);
        }

        h1 { font-size: 2.5em; }
        h2 { font-size: 2em; }
        h3 { font-size: 1.5em; }

        p, ul, ol {
            margin-bottom: 1em;
        }

        ul, ol {
            padding-left: 20px;
        }

        a {
            color: var(--primary-accent);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        strong {
            color: var(--dark-text);
            font-weight: 600;
        }

        body.light-mode strong {
            color: var(--light-text);
        }

        /* 6. Code Blocks & Copy Button */
        pre {
            background-color: var(--dark-bg);
            border: 1px solid var(--dark-border);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            position: relative;
            margin-bottom: 1em;
        }

        body.light-mode pre {
             background-color: var(--light-bg-secondary);
             border: 1px solid var(--light-border);
        }

        code {
            font-family: "SF Mono", "Consolas", "Liberation Mono", Menlo, monospace;
            font-size: 0.9em;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--dark-border);
            color: var(--dark-text-secondary);
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            opacity: 0.7;
            transition: opacity 0.2s ease, background-color 0.2s ease;
        }

        body.light-mode .copy-btn {
            background-color: var(--light-border);
            color: var(--light-text-secondary);
        }

        pre:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background-color: var(--primary-accent);
            color: white;
        }

        /* 7. Callout Boxes */
        .callout {
            padding: 15px 20px;
            margin: 20px 0;
            border-left: 5px solid;
            border-radius: 4px;
        }
        .info {
            background-color: rgba(94, 86, 240, 0.1);
            border-color: var(--primary-accent);
        }
        .warning {
            background-color: rgba(255, 193, 7, 0.1);
            border-color: var(--yellow);
        }
        .tip {
            background-color: rgba(40, 167, 69, 0.1);
            border-color: var(--green);
        }

        /* 8. Interactive Elements */
        #search-box {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            background-color: var(--dark-bg);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--dark-text);
            font-size: 1em;
        }

        body.light-mode #search-box {
            background-color: var(--light-bg-secondary);
            border: 1px solid var(--light-border);
            color: var(--light-text);
        }

        #theme-toggle {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: none;
            border: 1px solid var(--dark-border);
            color: var(--dark-text-secondary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
        }

        body.light-mode #theme-toggle {
            border: 1px solid var(--light-border);
            color: var(--light-text-secondary);
        }

        /* 9. Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid var(--dark-border);
            }
            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 20px;
            }
             body.light-mode .sidebar {
                border-bottom: 1px solid var(--light-border);
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <nav class="sidebar">
            <h2>QuantumEdge Terminal</h2>
            <input type="text" id="search-box" placeholder="Search topics...">
            <ul id="nav-links">
                <li><a href="#welcome" class="active">Welcome</a></li>
                <li><a href="#getting-started">Getting Started</a></li>
                <li><a href="#main-interface">The Main Interface</a></li>
                <li><a href="#connections">Connecting to Exchanges</a></li>
                <li><a href="#portfolio">Portfolio Management</a></li>
                <li><a href="#trading-engine">The Trading Engine</a></li>
                <li><a href="#backtester">The Backtester</a></li>
                <li><a href="#visual-builder">üé® Visual Strategy Builder</a></li>
                <li><a href="#advanced-tools">üöÄ Advanced Tools</a></li>
                <li><a href="#marketplace">üåê The Marketplace</a></li>
                <li><a href="#troubleshooting">Troubleshooting & FAQ</a></li>
                <li><a href="#appendix-strategies">Appendix: Strategies</a></li>
            </ul>
            <button id="theme-toggle">‚òÄÔ∏è</button>
        </nav>

        <main class="main-content">
            <article id="welcome" class="active">
                <h1>Welcome to QuantumEdge Terminal</h1>
                <p>This comprehensive user manual will guide you through every feature of the QuantumEdge Terminal, from initial setup to deploying advanced, AI-powered trading strategies. Our goal is to provide you with a powerful, intuitive, and robust tool for algorithmic trading.</p>
                <div class="info">
                    <strong>What is QuantumEdge Terminal?</strong><br>
                    It is a multi-platform desktop application designed to automate your trading strategies on both MetaTrader 5 and Binance. It features a powerful backtesting engine, a no-code visual strategy builder, an AI-powered analysis toolkit, and a marketplace for premium strategies.
                </div>
            </article>

            <article id="getting-started">
                <h1>Getting Started</h1>
                <h3>1. First Launch & Login</h3>
                <p>When you first launch the application, you will be prompted to log in or register. This account is for the <strong>QuantumEdge Marketplace</strong>. It allows you to subscribe to premium strategies and publish your own creations. This is separate from your broker or exchange account.</p>
                <h3>2. The .env File (For AI Strategy)</h3>
                <p>To use the "AI Signal Confirmation" strategy, you must have a Google Gemini API key. Create a file named <code>.env</code> in the application's root directory and add your key like this:</p>
<pre><code>GEMINI_API_KEY="your-secret-google-api-key"</code></pre>
            </article>

            <article id="main-interface">
                <h1>The Main Interface</h1>
                <p>The application is divided into three main areas for ease of use.</p>
                <h3>1. The Left Control Panel</h3>
                <ul>
                    <li><strong>Connection:</strong> Select your platform (MT5/Binance) and enter your credentials here. You can also configure Telegram notifications.</li>
                    <li><strong>Account Information:</strong> Once connected, this panel displays your live account balance, equity, profit, and free margin.</li>
                    <li><strong>Strategy Engine:</strong> The main "Start/Stop Bot" button that activates or deactivates the live trading loop.</li>
                    <li><strong>Market Chart:</strong> A professional candlestick chart that displays live and historical data for any symbol and timeframe.</li>
                </ul>
                <h3>2. The Right Tab Panel</h3>
                <p>This is where you'll spend most of your time managing and analyzing strategies.</p>
                <ul>
                    <li><strong>Portfolio & Live Positions:</strong> Manage your personal collection of strategies and monitor your currently open trades.</li>
                    <li><strong>Visual Strategy Builder:</strong> A no-code, drag-and-drop canvas for building custom strategies.</li>
                    <li><strong>Backtester:</strong> Test your strategies against historical data before deploying them live.</li>
                    <li><strong>Advanced Analytics:</strong> Visualize your backtest and live performance with equity curves and drawdown charts.</li>
                    <li><strong>Marketplace:</strong> Discover, subscribe to, and publish trading strategies.</li>
                    <li><strong>System Logs:</strong> A raw log of all actions taken by the application and the trading bot.</li>
                </ul>
                <h3>3. The Menu and Status Bar</h3>
                <ul>
                    <li><strong>Menu Bar (Top):</strong> Contains access to all features, including advanced tools, preferences, and safety features like the "Panic" button.</li>
                    <li><strong>Status Bar (Bottom):</strong> Provides at-a-glance information about your connection status and whether the trading bot is active.</li>
                </ul>
            </article>

            <article id="connections">
                <h1>Connecting to Exchanges</h1>
                <h3>Connecting to MetaTrader 5</h3>
                <ol>
                    <li>Select "MetaTrader 5" from the Platform dropdown.</li>
                    <li>Enter your MT5 <strong>Account Number</strong> in the "Login" field.</li>
                    <li>Enter your MT5 <strong>Main Password</strong> in the "Password" field.</li>
                    <li>Enter your broker's <strong>Server Name</strong> (e.g., "XMTrading-MT5 3").</li>
                    <li>Click "Connect". The status bar will update to show the connection status.</li>
                </ol>
                <div class="warning">
                    <strong>Important:</strong> The MetaTrader 5 terminal must be installed and running on your computer for the connection to succeed.
                </div>
                <h3>Connecting to Binance</h3>
                <ol>
                    <li>Select "Binance" from the Platform dropdown.</li>
                    <li>Enter your Binance <strong>API Key</strong>.</li>
                    <li>Enter your Binance <strong>API Secret</strong>.</li>
                    <li>Click "Connect".</li>
                </ol>
                <div class="tip">
                    For security, it is highly recommended to create a new API key specifically for this application and only enable Spot Trading permissions.
                </div>
            </article>

            <article id="portfolio">
                <h1>Portfolio Management</h1>
                <p>The "Portfolio & Live Positions" tab is your central hub for managing the strategies you want the bot to trade.</p>
                <h3>Adding a Strategy</h3>
                <ol>
                    <li>Click the <strong>"Add Strategy"</strong> button.</li>
                    <li>In the dialog, select a base strategy from the dropdown (e.g., "MACD Trend w/ ADX Filter").</li>
                    <li>Enter the Symbol (e.g., "BTC/USD") and Timeframe you want to trade.</li>
                    <li>Adjust the strategy-specific parameters and risk settings.</li>
                    <li>Click "OK" to add it to your portfolio.</li>
                </ol>
                <h3>Activating a Strategy</h3>
                <p>A strategy must be active for the trading bot to use it. To activate one:</p>
                <ol>
                    <li>Select the strategy in the portfolio table.</li>
                    <li>Click the <strong>"Activate"</strong> button. Its status will change to "ACTIVE".</li>
                    <li>To deactivate, select it and click "Deactivate".</li>
                </ol>
                 <h3>Saving and Loading Portfolios</h3>
                 <p>You can save different collections of strategies for different market conditions. Use the <strong>File > Save Portfolio As...</strong> menu option to save your current setup. Use <strong>File > Load Portfolio...</strong> to load a previously saved file.</p>
            </article>

            <article id="trading-engine">
                <h1>The Trading Engine</h1>
                <h3>Starting the Bot</h3>
                <p>Once you are connected to an exchange and have at least one <strong>active</strong> strategy in your portfolio, you can start the trading bot by clicking the <strong>"Start Bot"</strong> button in the left panel. The status bar will update to "BOT: ACTIVE".</p>
                <h3>How It Works</h3>
                <p>The trading engine operates on a 30-second cycle:</p>
                <ol>
                    <li>It loops through all of your <strong>active</strong> strategies.</li>
                    <li>For each strategy, it fetches the latest market data.</li>
                    <li>It runs the strategy's logic to see if a BUY, SELL, or CLOSE signal is generated.</li>
                    <li>It checks if a position for that specific strategy already exists on that symbol.</li>
                    <li>If a signal is found and no position exists, it executes a trade. If a CLOSE signal is found and a position *does* exist, it closes the trade.</li>
                    <li>It then waits 30 seconds and repeats the cycle.</li>
                </ol>
                <div class="info">
                    The bot will <strong>never</strong> open a new trade for a strategy that already has an open position on the same symbol. This prevents duplicate trades.
                </div>
                <h3>üö® The Panic Button</h3>
                <p>In the <strong>Trading > PANIC: Close All Positions</strong> menu, you will find a critical safety feature. Clicking this (and confirming) will immediately send market close orders for every single position open on your account, regardless of which strategy opened them. This is for emergency use during extreme market volatility.</p>
            </article>

            <article id="backtester">
                <h1>The Backtester</h1>
                <p>The backtester allows you to test your strategies against thousands of bars of historical data to evaluate their performance before risking real money.</p>
                <h3>Running a Backtest</h3>
                <ol>
                    <li>Go to the "Backtester" tab.</li>
                    <li>Select a strategy from your portfolio using the dropdown.</li>
                    <li>The Symbol and Timeframe will be pre-filled from your strategy config, but you can override them.</li>
                    <li>Click the <strong>"Run Backtest"</strong> button.</li>
                    <li>The process will run, showing progress in the bar and detailed logs in the text area.</li>
                </ol>
                <h3>Interpreting the Results</h3>
                <p>Once complete, the "Key Metrics" will be populated, and you will be automatically switched to the "Advanced Analytics" tab.</p>
                <ul>
                    <li><strong>Total Return:</strong> The total percentage gain or loss over the backtest period.</li>
                    <li><strong>Final Equity:</strong> The final account balance, assuming a start of $10,000.</li>
                    <li><strong>Max Drawdown:</strong> The largest peak-to-trough drop in equity, representing the biggest loss streak. Lower is better.</li>
                    <li><strong>Sharpe Ratio:</strong> Measures risk-adjusted return. Generally, a value > 1 is considered good.</li>
                    <li><strong>Equity Curve Chart:</strong> A visual representation of your account balance over time. An ideal curve is smooth and consistently upward-sloping.</li>
                </ul>
            </article>

            <article id="visual-builder">
                <h1>üé® Visual Strategy Builder</h1>
                <p>The Visual Strategy Builder is a powerful no-code tool that lets you design custom trading logic by connecting nodes on a canvas.</p>
                <h3>The Core Nodes</h3>
                <ul>
                    <li><strong>Indicator Node:</strong> The starting point. Provides a data series like RSI, EMA, or MACD.</li>
                    <li><strong>Condition Node:</strong> Compares an input to a value (e.g., "Is RSI Below 30?"). Outputs a True/False signal.</li>
                    <li><strong>Operator Node:</strong> Combines two True/False signals with AND/OR logic.</li>
                    <li><strong>Action Node:</strong> The final step. Takes a True signal and executes a BUY, SELL, or CLOSE action.</li>
                </ul>
                <h3>Example: Building an RSI Reversion Strategy</h3>
                <ol>
                    <li>Add an <strong>Indicator Node</strong>. Set its type to "RSI" and parameter to "14".</li>
                    <li>Add a <strong>Condition Node</strong>. Set its type to "Below" and value to "30".</li>
                    <li>Add an <strong>Action Node</strong>. Set its type to "BUY".</li>
                    <li><strong>Connect the nodes:</strong> Drag a line from the output socket of the RSI node to the input socket of the Condition node. Then, drag a line from the output of the Condition node to the input of the BUY Action node.</li>
                    <li>Give your strategy a name (e.g., "My RSI Buyer") and click <strong>"Save to Portfolio"</strong>.</li>
                </ol>
                <p>Your new visual strategy will now appear in your portfolio and can be backtested and run live just like any coded strategy!</p>
            </article>

            <article id="advanced-tools">
                <h1>üöÄ Advanced Tools</h1>
                <p>The <strong>Analysis & Tools</strong> menu contains features for power users to gain a deeper edge.</p>
                <h3>Strategy Optimizer</h3>
                <p>This tool uses a genetic algorithm to find the most profitable parameters for a strategy. It will run hundreds of backtests in the background, evolving the parameters (like RSI period, EMA length) over many "generations" to find the optimal combination for the selected market.</p>
                <h3>Portfolio Correlation Matrix</h3>
                <p>This tool analyzes your live trade history and shows you how correlated your active strategies are. A high correlation (close to +1.0) means two strategies tend to win and lose at the same time. A low or negative correlation is often desirable as it means your strategies are diversified, smoothing your equity curve.</p>
                <h3>ML Model Manager</h3>
                <p>This dashboard allows you to manage the AI model used by the "AI Signal Confirmation" strategy. Here you can see model details and, most importantly, trigger the retraining script (<code>train_model.py</code>). This allows you to update the model's intelligence with the latest market data.</p>
                <h3>Economic Calendar</h3>
                <p>Displays high-impact economic news events for the selected day. This is crucial for avoiding periods of extreme market volatility that can negatively affect algorithmic strategies.</p>
            </article>

            <article id="marketplace">
                <h1>üåê The Marketplace</h1>
                <p>The marketplace is an ecosystem for discovering and sharing strategies.</p>
                <h3>Subscribing to Strategies</h3>
                <ol>
                    <li>Go to the "Marketplace" tab.</li>
                    <li>Browse the available strategies from approved creators.</li>
                    <li>Click the "Subscribe" button for a strategy you are interested in.</li>
                    <li>A payment dialog will appear, providing a unique TRC20 USDT address to send the subscription fee to.</li>
                    <li>Once the blockchain transaction is confirmed, the strategy will be automatically added to your portfolio under the name "üåê [Strategy Name]".</li>
                </ol>
                <h3>Publishing Your Strategy</h3>
                <p>If you have created a profitable strategy using the Visual Builder, you can submit it to the marketplace for others to subscribe to.</p>
                <ol>
                    <li>Go to <strong>Marketplace > Publish a Strategy...</strong> in the menu.</li>
                    <li>Select one of your saved <strong>Visual Strategies</strong> from the dropdown.</li>
                    <li>Write a compelling description and set your monthly subscription price in USD.</li>
                    <li>Click "Submit for Review". Our team will backtest your strategy, and if approved, it will be listed in the marketplace.</li>
                </ol>
            </article>

            <article id="troubleshooting">
                <h1>Troubleshooting & FAQ</h1>
                <h3>MT5 Connection Failed: "initialize() failed"</h3>
                <p>This is the most common issue. Check the following:</p>
                <ul>
                    <li>Is the MetaTrader 5 terminal application running on your computer? It must be.</li>
                    <li>Are your Login, Password, and Server details 100% correct?</li>
                    <li>In MT5, go to Tools > Options > Expert Advisors. Is "Allow algorithmic trading" checked?</li>
                </ul>
                <h3>AI Strategy Disabled / DLL Error</h3>
                <p>The "AI Signal Confirmation" strategy requires a specific Microsoft runtime library. If you see a "DLL load failed" error in the logs, you need to install it.</p>
                <div class="tip">
                    <strong>Solution:</strong> Search for and install the "Microsoft Visual C++ Redistributable" for Visual Studio 2015-2022. Download the X64 version from the official Microsoft website.
                </div>
                <h3>Bot is Active but Not Placing Trades</h3>
                <ul>
                    <li>Are any strategies in your portfolio set to "ACTIVE"?</li>
                    <li>Check the System Logs. The strategy might be generating "HOLD" signals. This is normal if market conditions don't meet the strategy's criteria.</li>
                    <li>Does your account have sufficient free margin to open a trade?</li>
                </ul>
            </article>

            <article id="appendix-strategies">
                <h1>Appendix: Included Strategies</h1>
                <h3>Trend Following</h3>
                <ul>
                    <li><strong>Adaptive EMA Crossover:</strong> A classic trend strategy using a fast and slow Exponential Moving Average.</li>
                    <li><strong>MACD Trend w/ ADX Filter:</strong> Uses MACD crossovers for signals but only enters during strong trends as confirmed by the ADX indicator.</li>
                    <li><strong>SuperTrend w/ ADX Filter:</strong> Enters on a SuperTrend direction change, filtered by the ADX for trend strength.</li>
                </ul>
                <h3>Mean Reversion</h3>
                <ul>
                    <li><strong>RSI & Bollinger Reversion:</strong> A classic range-trading strategy. Buys when price hits the lower Bollinger Band and RSI is oversold; sells on the opposite conditions.</li>
                </ul>
                 <h3>Breakout</h3>
                <ul>
                    <li><strong>Volatility Squeeze:</strong> Identifies periods of low volatility (a "squeeze") and enters a trade when the price breaks out forcefully in either direction.</li>
                </ul>
                 <h3>Advanced</h3>
                <ul>
                    <li><strong>Ichimoku Cloud Breakout:</strong> A comprehensive trend strategy based on the Japanese Ichimoku Kinko Hyo indicator.</li>
                    <li><strong>Smart Money Concept (SMC):</strong> An advanced strategy that attempts to identify high-probability "Order Blocks" and "Fair Value Gaps" left by institutional traders.</li>
                    <li><strong>AI Signal Confirmation:</strong> A hybrid strategy that first finds a basic EMA crossover signal and then uses a machine learning model to confirm if the trade has a high probability of success.</li>
                    <li><strong>Optimizer Portfolio:</strong> A "meta-strategy" that monitors signals from a pool of other strategies and only trades when multiple strategies agree (confluence), filtering signals based on the overall market trend.</li>
                </ul>
            </article>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.sidebar ul li a');
            const articles = document.querySelectorAll('.main-content article');
            const searchBox = document.getElementById('search-box');
            const themeToggle = document.getElementById('theme-toggle');

            // --- Navigation Logic ---
            const showArticle = (id) => {
                articles.forEach(article => article.classList.remove('active'));
                navLinks.forEach(link => link.classList.remove('active'));

                const targetArticle = document.getElementById(id);
                const targetLink = document.querySelector(`a[href="#${id}"]`);

                if (targetArticle) targetArticle.classList.add('active');
                if (targetLink) targetLink.classList.add('active');
            };

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const articleId = link.getAttribute('href').substring(1);
                    showArticle(articleId);
                    window.location.hash = articleId;
                });
            });

            // Handle initial load with hash
            if (window.location.hash) {
                showArticle(window.location.hash.substring(1));
            }

            // --- Search Functionality ---
            searchBox.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                navLinks.forEach(link => {
                    const linkText = link.textContent.toLowerCase();
                    const parentLi = link.parentElement;
                    if (linkText.includes(searchTerm)) {
                        parentLi.style.display = 'block';
                    } else {
                        parentLi.style.display = 'none';
                    }
                });
            });

            // --- Code Block Copy Buttons ---
            document.querySelectorAll('pre').forEach(pre => {
                const button = document.createElement('button');
                button.className = 'copy-btn';
                button.textContent = 'Copy';
                pre.appendChild(button);

                button.addEventListener('click', () => {
                    const code = pre.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
            });

            // --- Theme Toggle ---
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('light-mode');
                if (document.body.classList.contains('light-mode')) {
                    themeToggle.textContent = 'üåô';
                } else {
                    themeToggle.textContent = '‚òÄÔ∏è';
                }
            });
        });
    </script>
</body>
</html>